v {xschem version=3.1.0 file_version=1.2
}
G {}
K {}
V {}
S {}
E {}
N 1600 -200 1600 -190 {
lab=Vref}
N 1600 -130 1600 -50 {
lab=GND}
N 1310 -190 1480 -190 {
lab=#net1}
N 1530 -190 1530 -180 {
lab=#net1}
N 1530 -120 1530 -100 {
lab=GND}
N 1310 -170 1330 -170 {
lab=GND}
N 1340 120 1340 140 {
lab=GND}
N 1310 -150 1340 -150 {
lab=Vreg}
N 1410 120 1410 130 {
lab=GND}
N 1340 130 1410 130 {
lab=GND}
N 1340 -150 1410 -150 {
lab=Vreg}
N 1410 -150 1430 -150 {
lab=Vreg}
N 960 -40 960 -30 {
lab=GND}
N 1480 -190 1530 -190 {
lab=#net1}
N 960 -90 960 -40 {
lab=GND}
N 960 -210 960 -150 {
lab=Vdd}
N 1600 -210 1600 -200 {
lab=Vref}
N 1310 -210 1600 -210 {
lab=Vref}
N 960 -230 1010 -230 {
lab=Vdd}
N 960 -230 960 -210 {
lab=Vdd}
N 1340 -150 1340 -120 {
lab=Vreg}
N 1410 -60 1410 20 {
lab=GND}
N 1340 100 1340 120 {
lab=GND}
N 1410 20 1410 120 {
lab=GND}
N 1410 -150 1410 -120 {
lab=Vreg}
N 1600 520 1600 530 {
lab=#net2}
N 1600 590 1600 670 {
lab=GND}
N 1530 530 1530 540 {
lab=#net3}
N 1530 600 1530 620 {
lab=GND}
N 1310 550 1330 550 {
lab=GND}
N 1340 840 1340 860 {
lab=GND}
N 1310 570 1340 570 {
lab=Vreg2}
N 1410 840 1410 850 {
lab=GND}
N 1340 850 1410 850 {
lab=GND}
N 1340 570 1410 570 {
lab=Vreg2}
N 1410 570 1430 570 {
lab=Vreg2}
N 960 680 960 690 {
lab=GND}
N 960 630 960 680 {
lab=GND}
N 960 510 960 570 {
lab=#net4}
N 1600 510 1600 520 {
lab=#net2}
N 1310 510 1600 510 {
lab=#net2}
N 960 490 1010 490 {
lab=#net4}
N 960 490 960 510 {
lab=#net4}
N 1340 570 1340 600 {
lab=Vreg2}
N 1410 660 1410 740 {
lab=GND}
N 1340 820 1340 840 {
lab=GND}
N 1410 740 1410 840 {
lab=GND}
N 1410 570 1410 600 {
lab=Vreg2}
N 1430 -150 1430 210 {
lab=Vreg}
N 1270 210 1430 210 {
lab=Vreg}
N 1140 370 1140 390 {
lab=GND}
N 1140 290 1140 310 {
lab=Vt}
N 1140 210 1210 210 {
lab=#net5}
N 1140 210 1140 230 {
lab=#net5}
N 880 210 1140 210 {
lab=#net5}
N 880 -300 880 210 {
lab=#net5}
N 880 -300 1360 -300 {
lab=#net5}
N 1360 -300 1360 -230 {
lab=#net5}
N 1310 -230 1360 -230 {
lab=#net5}
N 880 430 880 930 {
lab=#net6}
N 880 430 1350 430 {
lab=#net6}
N 1350 430 1350 490 {
lab=#net6}
N 1310 490 1350 490 {
lab=#net6}
N 1340 210 1340 230 {
lab=Vreg}
N 1320 570 1320 630 {
lab=Vreg2}
N 1280 630 1320 630 {
lab=Vreg2}
N 1280 630 1280 930 {
lab=Vreg2}
N 1270 930 1280 930 {
lab=Vreg2}
N 880 930 1210 930 {
lab=#net6}
N 1340 290 1340 380 {
lab=#net6}
N 1340 380 1340 430 {
lab=#net6}
N 1310 530 1530 530 {
lab=#net3}
N 230 150 330 150 {
lab=#net7}
N 190 180 190 320 {
lab=#net7}
N 370 180 370 320 {
lab=vout}
N 190 90 190 120 {
lab=Vdd}
N 370 90 370 120 {
lab=Vdd}
N 190 90 370 90 {
lab=Vdd}
N 280 70 280 90 {
lab=Vdd}
N 190 210 260 210 {
lab=#net7}
N 260 150 260 210 {
lab=#net7}
N 190 380 190 410 {
lab=#net8}
N 190 410 370 410 {
lab=#net8}
N 370 380 370 410 {
lab=#net8}
N 280 410 280 440 {
lab=#net8}
N 280 500 280 520 {
lab=Vss}
N 190 350 370 350 {
lab=Vss}
N 280 350 280 360 {
lab=Vss}
N 170 150 190 150 {
lab=Vdd}
N 170 110 170 150 {
lab=Vdd}
N 170 110 190 110 {
lab=Vdd}
N 370 150 390 150 {
lab=Vdd}
N 390 110 390 150 {
lab=Vdd}
N 370 110 390 110 {
lab=Vdd}
N 210 470 240 470 {
lab=Vb}
N 280 470 300 470 {
lab=Vss}
N 300 470 300 510 {
lab=Vss}
N 280 510 300 510 {
lab=Vss}
N 370 210 460 210 {
lab=vout}
N 460 210 500 210 {
lab=vout}
N 280 360 280 390 {
lab=Vss}
N 280 390 340 390 {
lab=Vss}
N 340 390 340 530 {
lab=Vss}
N 280 520 280 530 {
lab=Vss}
N 470 530 470 550 {
lab=Vss}
N 470 550 470 560 {
lab=Vss}
N 280 530 470 530 {
lab=Vss}
N 130 350 150 350 {
lab=vinp}
N 410 350 430 350 {
lab=vinm}
N -350 150 -250 150 {
lab=#net9}
N -390 180 -390 320 {
lab=#net9}
N -210 180 -210 320 {
lab=vout}
N -390 90 -390 120 {
lab=Vdd}
N -210 90 -210 120 {
lab=Vdd}
N -390 90 -210 90 {
lab=Vdd}
N -300 70 -300 90 {
lab=Vdd}
N -390 210 -320 210 {
lab=#net9}
N -320 150 -320 210 {
lab=#net9}
N -390 380 -390 410 {
lab=#net10}
N -390 410 -210 410 {
lab=#net10}
N -210 380 -210 410 {
lab=#net10}
N -300 410 -300 440 {
lab=#net10}
N -300 500 -300 520 {
lab=Vss}
N -390 350 -210 350 {
lab=Vss}
N -300 350 -300 360 {
lab=Vss}
N -410 150 -390 150 {
lab=Vdd}
N -410 110 -410 150 {
lab=Vdd}
N -410 110 -390 110 {
lab=Vdd}
N -210 150 -190 150 {
lab=Vdd}
N -190 110 -190 150 {
lab=Vdd}
N -210 110 -190 110 {
lab=Vdd}
N -370 470 -340 470 {
lab=Vb}
N -300 470 -280 470 {
lab=Vss}
N -280 470 -280 510 {
lab=Vss}
N -300 510 -280 510 {
lab=Vss}
N -210 210 -120 210 {
lab=vout}
N -120 210 -80 210 {
lab=vout}
N -300 360 -300 390 {
lab=Vss}
N -300 390 -240 390 {
lab=Vss}
N -240 390 -240 530 {
lab=Vss}
N -300 520 -300 530 {
lab=Vss}
N -110 530 -110 550 {
lab=Vss}
N -110 550 -110 560 {
lab=Vss}
N -300 530 -110 530 {
lab=Vss}
N -450 350 -430 350 {
lab=vinp}
N -170 350 -150 350 {
lab=vinm}
N 1340 -60 1340 100 {
lab=GND}
N 1340 660 1340 820 {
lab=GND}
C {devices/gnd.sym} 1600 -50 0 0 {name=l1 lab=GND}
C {devices/vsource.sym} 1600 -160 0 0 {name=Vref value="ac 0 dc Vref"}
C {devices/vsource.sym} 1530 -150 0 0 {name=Vb value=Vb}
C {devices/gnd.sym} 1530 -100 0 0 {name=l3 lab=GND}
C {devices/gnd.sym} 1330 -170 3 0 {name=l4 lab=GND}
C {devices/gnd.sym} 1340 140 0 0 {name=l5 lab=GND}
C {devices/isource.sym} 1410 -90 0 0 {name=IL value=IL}
C {devices/opin.sym} 1430 -150 0 0 {name=p7 lab=Vreg}
C {devices/gnd.sym} 960 -30 0 0 {name=l7 lab=GND}
C {devices/vsource.sym} 960 -120 0 0 {name=Vdd value="ac 1 dc Vdd sin(0 Vamp f_Vdd)"}
C {devices/lab_pin.sym} 960 -210 0 0 {name=p8 sig_type=std_logic lab=Vdd}
C {ldo.sym} 1160 -190 0 0 {name=x1}
C {devices/lab_pin.sym} 1600 -210 2 0 {name=p9 sig_type=std_logic lab=Vref}
C {devices/gnd.sym} 1600 670 0 0 {name=l6 lab=GND}
C {devices/vsource.sym} 1600 560 0 0 {name=Vref1 value=Vref}
C {devices/vsource.sym} 1530 570 0 0 {name=Vb2 value=Vb}
C {devices/gnd.sym} 1530 620 0 0 {name=l8 lab=GND}
C {devices/gnd.sym} 1330 550 3 0 {name=l9 lab=GND}
C {devices/gnd.sym} 1340 860 0 0 {name=l10 lab=GND}
C {devices/isource.sym} 1410 630 0 0 {name=IL1 value=IL}
C {devices/opin.sym} 1430 570 0 0 {name=p10 lab=Vreg2}
C {devices/gnd.sym} 960 690 0 0 {name=l11 lab=GND}
C {devices/vsource.sym} 960 600 0 0 {name=Vdd3 value=Vdd}
C {ldo.sym} 1160 530 0 0 {name=x2}
C {devices/ind.sym} 1240 210 3 0 {name=L13
m=1
value=1e10
footprint=1206
device=inductor}
C {devices/capa.sym} 1140 260 0 0 {name=C3
m=1
value=1e10
footprint=1206
device="ceramic capacitor"}
C {devices/gnd.sym} 1140 390 0 0 {name=l14 lab=GND}
C {devices/vsource.sym} 1140 340 0 0 {name=Vt value="ac 1"}
C {devices/capa.sym} 1340 260 0 0 {name=C4
m=1
value=1e10
footprint=1206
device="ceramic capacitor"}
C {devices/ind.sym} 1240 930 3 0 {name=L15
m=1
value=1e10
footprint=1206
device=inductor}
C {devices/lab_pin.sym} 1140 300 2 0 {name=p11 sig_type=std_logic lab=Vt}
C {devices/code_shown.sym} 840 1170 0 0 {name=s1 only_toplevel=false value=".lib /usr/local/share/pdk/sky130A/libs.tech/ngspice/sky130.lib.spice tt"}
C {devices/code_shown.sym} 840 1330 0 0 {name=s4 only_toplevel=false 
value="
.control
save all 
set filetype=ascii
set units=degrees

* DC sweep
dc Vdd 0 3 0.01
plot v(Vdd) v(Vreg)
wrdata ldo_tb_dc v(Vreg)

* Stability_Analysis ver2 using large ind and cap
alter IL dc=100u
alter Vdd ac=0
alter Vref ac=0
alter Vt ac=1
ac dec 100 1 10G
let L2=-v(Vreg)/v(Vt)
plot vdb(L2) vp(L2) xlog

.endc
"}
C {devices/code_shown.sym} 840 1250 0 0 {name=s2 only_toplevel=false value=".include /autofs/fs1.ece/fs1.eecg.tcc/lizongh2/sky130_ldo/xschem/simulations/ldo_tb_vars.spice
"}
C {devices/iopin.sym} 280 70 0 0 {name=p1 lab=Vdd}
C {devices/ipin.sym} 430 350 2 0 {name=p2 lab=vinm}
C {devices/ipin.sym} 130 350 0 0 {name=p3 lab=vinp}
C {devices/iopin.sym} 210 470 2 0 {name=p4 lab=Vb}
C {devices/opin.sym} 500 210 0 0 {name=p5 lab=vout}
C {devices/iopin.sym} 470 560 0 0 {name=p6 lab=Vss}
C {sky130_fd_pr/nfet_01v8.sym} 260 470 0 0 {name=M5
L=L_M5
W=W_M5
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 350 150 0 0 {name=M3
L=L_M3
W=W_M3
body=VDD
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 210 150 0 1 {name=M4
L=L_M4
W=W_M4
body=VDD
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 170 350 0 0 {name=M1
L=L_M1
W=W_M1
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 390 350 0 1 {name=M2
L=L_M2
W=W_M2
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {devices/iopin.sym} -300 70 0 0 {name=p12 lab=Vdd}
C {devices/ipin.sym} -150 350 2 0 {name=p13 lab=vinm}
C {devices/ipin.sym} -450 350 0 0 {name=p14 lab=vinp}
C {devices/iopin.sym} -370 470 2 0 {name=p15 lab=Vb}
C {devices/opin.sym} -80 210 0 0 {name=p16 lab=vout}
C {devices/iopin.sym} -110 560 0 0 {name=p17 lab=Vss}
C {sky130_fd_pr/nfet_g5v0d10v5.sym} -410 350 0 0 {name=M6
L=L_M1
W=W_M1
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_g5v0d10v5
spiceprefix=X
}
C {sky130_fd_pr/nfet_g5v0d10v5.sym} -190 350 0 1 {name=M7
L=L_M2
W=W_M2
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_g5v0d10v5
spiceprefix=X
}
C {sky130_fd_pr/pfet_g5v0d10v5.sym} -230 150 0 0 {name=M8
L=L_M3
W=W_M3
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_g5v0d10v5
spiceprefix=X
}
C {sky130_fd_pr/pfet_g5v0d10v5.sym} -370 150 0 1 {name=M9
L=L_M4
W=W_M4
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_g5v0d10v5
spiceprefix=X
}
C {sky130_fd_pr/nfet_g5v0d10v5.sym} -320 470 0 0 {name=M10
L=L_M5
W=W_M5
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_g5v0d10v5
spiceprefix=X
}
C {sky130_fd_pr/cap_mim_m3_1.sym} 1340 -90 0 0 {name=C1 model=cap_mim_m3_1 W=30 L=30 MF=M_CL spiceprefix=X}
C {sky130_fd_pr/cap_mim_m3_1.sym} 1340 630 0 0 {name=C2 model=cap_mim_m3_1 W=30 L=30 MF=M_CL spiceprefix=X}
